import{au as Y,h as A,d as N,at as I,b as j,o as s,H as Z,av as ee,ad as _,c as i,j as n,G as h,t as f,e as E,a as F,k as r,_ as B,aw as k,F as b,B as y,ax as te,p as x,ay as ae,az as oe,C as V,aA as le,w as M,ae as ne,K as se,aB as re,N as ie,n as ue}from"./chunks/framework.D1p3cIHr.js";import{d as ce,s as H}from"./chunks/theme.C6oiRwOp.js";import{g as de,a as ve,b as pe,m as fe,c as me}from"./chunks/member.BJSrVM8h.js";const ge=/^[a-z][*+.a-z-]+:\/\//i,_e=/^([a-z][*+.a-z-]+:\/\/)([^[][^/?]*:[^/?]*:[^/?]*)(.*)/i,L=Symbol("NO_HOSTNAME"),be=e=>{if(typeof URL!="function")throw new Error("Looks like the new URL() constructor is not globally available in your environment. Please make sure to use a polyfill.");if(typeof e!="string")return L;let t=e.startsWith("//")?`http:${e}`:e.startsWith("/")||ge.test(e)?e:`http://${e}`;t=t.replace(_e,"$1[$2]$3");try{return new URL(t).hostname}catch{return L}};function G(e){const t=be(e);return typeof t=="symbol"?e:t}function he(e,t){const d={};Object.keys(t).forEach(o=>{const l=t[o];l==null||l===""||(d[o]=typeof l=="object"?JSON.stringify(l):String(l))});const a=new URLSearchParams(d).toString();return e+(e.includes("?")?"&":"?")+a}const T={author:"raw",avatar:"name",size:"medium",wide:!0,api:"prod"},q={raw:{label:"原始值(Feed标题)",transform:()=>{}},name:{label:"姓名",transform:e=>e.name},github:{label:"GitHub用户名",transform:e=>e.github},link:{label:"博客域名",transform:e=>G(e.feed)}},J={none:{label:"不展示",transform:()=>{}},name:{label:"作者头像",transform:e=>de(e)},link:{label:"网站图标",transform:e=>`https://unavatar.webp.se/${G(e.feed)}?w`}},W={small:{label:"小",val:"16em"},medium:{label:"中",val:"20em"},large:{label:"大",val:"24em"}},K={prod:{label:"正常(生产环境)",transform:e=>new URL(e,"https://api.xiyoulinux.com").toString()},local:{label:"本地测试",transform:e=>new URL(e,"http://localhost:3000").toString()}},U=ce("article",()=>{const e=Y("article-preference",{...T});e.value={...T,...e.value};const t=l=>q[e.value.author].transform(l),d=l=>J[e.value.avatar].transform(l),a=A(()=>W[e.value.size].val);return{preference:e,getAuthor:t,getAvatar:d,size:a,api:l=>K[e.value.api].transform(l)}}),ye=N({__name:"AutoCode",props:{text:{},tag:{default:"span"}},setup(e){const t=e,d=A(()=>{if(!t.text)return I(t.tag);const o=t.text.split(/`([^`]+)`/g).map((l,v)=>v%2?I("code",l):l);return I(t.tag,o)});return(a,o)=>(s(),j(Z(d.value)))}}),we=["href"],xe={class:"title"},Se={class:"info-line"},$e=["src","alt"],ke={class:"author"},Ae=["datetime"],ze=N({__name:"ArticleItem",props:{_id:{},__v:{},createdAt:{},title:{},description:{},link:{},date:{},author:{},feed:{},tag:{}},setup(e){const t=e,d=U(),a=new Date(t.date).toLocaleString("zh-CN",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),o=ve(t.feed),l=A(()=>d.getAuthor(o)||t.author),v=A(()=>d.getAvatar(o));return(z,g)=>{const p=ee("scrollcheck");return _((s(),i("a",{class:"article-item",href:e.link,target:"_blank"},[n("div",xe,f(e.title),1),h(ye,{class:"summary scrollcheck-y",tag:"p",text:e.description},null,8,["text"]),n("div",Se,[v.value?(s(),i("img",{key:0,src:v.value,alt:r(o).name,class:"avatar"},null,8,$e)):E("",!0),n("span",ke,f(l.value),1),g[0]||(g[0]=F(" · ",-1)),n("time",{class:"date",datetime:e.date},f(r(a)),9,Ae)])],8,we)),[[p]])}}}),Ce=B(ze,[["__scopeId","data-v-e3d60c04"]]),Pe=["value"],Me=["value"],Ue=["value"],Ne=["value"],Ie=N({__name:"ArticlePreference",setup(e){const{preference:t}=H(U());return(d,a)=>(s(),i("form",null,[a[5]||(a[5]=n("label",{for:"author"},"来源展示",-1)),_(n("select",{id:"author","onUpdate:modelValue":a[0]||(a[0]=o=>r(t).author=o)},[(s(!0),i(b,null,y(r(q),(o,l)=>(s(),i("option",{key:l,value:l},f(o.label),9,Pe))),128))],512),[[k,r(t).author]]),a[6]||(a[6]=n("label",{for:"avatar"},"头像展示",-1)),_(n("select",{id:"avatar","onUpdate:modelValue":a[1]||(a[1]=o=>r(t).avatar=o)},[(s(!0),i(b,null,y(r(J),(o,l)=>(s(),i("option",{key:l,value:l},f(o.label),9,Me))),128))],512),[[k,r(t).avatar]]),a[7]||(a[7]=n("label",{for:"size"},"卡片尺寸",-1)),_(n("select",{id:"size","onUpdate:modelValue":a[2]||(a[2]=o=>r(t).size=o)},[(s(!0),i(b,null,y(r(W),(o,l)=>(s(),i("option",{key:l,value:l},f(o.label),9,Ue))),128))],512),[[k,r(t).size]]),a[8]||(a[8]=n("label",{for:"wide"},"宽屏",-1)),_(n("input",{id:"wide","onUpdate:modelValue":a[3]||(a[3]=o=>r(t).wide=o),type:"checkbox"},null,512),[[te,r(t).wide]]),a[9]||(a[9]=n("label",{for:"api"},"API",-1)),_(n("select",{id:"api","onUpdate:modelValue":a[4]||(a[4]=o=>r(t).api=o)},[(s(!0),i(b,null,y(r(K),(o,l)=>(s(),i("option",{key:l,value:l},f(o.label),9,Ne))),128))],512),[[k,r(t).api]])]))}}),Ve=B(Ie,[["__scopeId","data-v-38aace99"]]),Be={class:"vp-doc stats"},Oe=["href"],De=["href"],Re={class:"control sticky-header"},Le=["value"],Te=["onClick"],je=["onClick"],Ee=N({__name:"ArticleList",setup(e){const{preference:t,size:d}=H(U()),{api:a}=U(),o=x(!1),l={page:0,totalPages:1,total:0,limit:24},v=x({...l}),z=x([]),g=x(""),p=x(""),w=x(),O=A(()=>(g.value?pe(g.value):fe.filter(m=>m.grade===p.value||!p.value)).filter(m=>m.feed));function C(m={}){const{member:u,grade:S}=m;v.value={...l},z.value=[],g.value="",p.value=S||(u==null?void 0:u.grade)||"",w.value=u,window.scrollTo({top:0,behavior:"smooth"})}async function Q(){if(o.value)return;o.value=!0;const m=he(a("/articles"),{limit:v.value.limit,page:v.value.page+1,feed:w.value?w.value.feed||"null":void 0,tag:w.value?void 0:p.value}),u=await fetch(m),{articles:S,pagination:P}=await u.json();o.value=!1,v.value=P,z.value.push(...S)}const X=ae("load-trigger");return oe(X,([{isIntersecting:m}])=>{m&&Q()}),(m,u)=>{var R;const S=V("Badge"),P=V("Dropdown"),D=V("Icon");return s(),i(b,null,[n("h1",null,f(((R=w.value)==null?void 0:R.name)||p.value||"群博")+" - 文章列表",1),n("p",Be,[n("span",null,"共 "+f(v.value.total)+" 篇文章",1),n("a",{href:r(a)("/opml"),target:"_blank"},"OPML",8,Oe),n("a",{href:r(a)("/rss"),target:"_blank"},"RSS",8,De),u[4]||(u[4]=n("a",{href:"https://github.com/xiyou-linuxer/blog-feed",target:"_blank"},"API 源码",-1))]),n("div",Re,[_(n("select",{"onUpdate:modelValue":u[0]||(u[0]=c=>p.value=c),class:"bg-blur","aria-label":"年级选择",onChange:u[1]||(u[1]=c=>C({grade:p.value}))},[u[5]||(u[5]=n("option",{value:""}," 全部年级 ",-1)),(s(!0),i(b,null,y(r(me),({grade:c})=>(s(),i("option",{key:c,value:c},f(c)+" 级 ",9,Le))),128))],544),[[k,p.value]]),h(P,{trigger:"focusin",class:"search-dropdown"},le({default:M(()=>[_(n("input",{"onUpdate:modelValue":u[2]||(u[2]=c=>g.value=c),class:"bg-blur",type:"search",placeholder:"搜索成员"},null,512),[[ne,g.value]])]),_:2},[O.value?{name:"content",fn:M(({hide:c})=>[w.value&&!g.value?(s(),i("button",{key:0,onClick:$=>(c(),C({grade:p.value}))},f(p.value)+" 级全部 ",9,Te)):E("",!0),(s(!0),i(b,null,y(O.value,$=>(s(),i("button",{key:$.feed,onClick:Ge=>(c(),C({member:$}))},[F(f($.name)+" ",1),h(S,{type:"info",text:$.grade},null,8,["text"])],8,je))),128))]),key:"0"}:void 0]),1024),h(D,{icon:"ri:filter-off-line",class:"cursor-pointer",title:"重置筛选",onClick:u[3]||(u[3]=c=>C())}),h(P,{tag:"button",title:"偏好设置"},{content:M(()=>[h(Ve)]),default:M(()=>[h(D,{icon:"ri:list-settings-fill",class:"cursor-pointer"})]),_:1})]),n("section",{class:ue(["article-list",{narrow:!r(t).wide}]),style:ie({"--size":r(d)})},[(s(!0),i(b,null,y(z.value,c=>(s(),j(Ce,se({key:c._id||c.link},{ref_for:!0},c),null,16))),128)),(s(!0),i(b,null,y(v.value.limit,c=>_((s(),i("div",{ref_for:!0,ref:"load-trigger",key:c,class:"loading-item"})),[[re,v.value.page<v.value.totalPages]])),128))],6)],64)}}}),Fe=B(Ee,[["__scopeId","data-v-8f52ea17"]]),Ke=JSON.parse('{"title":"文章","description":"","frontmatter":{"layout":"page","sidebar":false,"title":"文章"},"headers":[],"relativePath":"blog/index.md","filePath":"blog/index.md","lastUpdated":null}'),He={name:"blog/index.md"},Qe=Object.assign(He,{setup(e){return(t,d)=>(s(),i("div",null,[h(Fe)]))}});export{Ke as __pageData,Qe as default};
